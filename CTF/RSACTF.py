from random import randrange

import libnum as libnum
from Crypto.Util.number import *
import gmpy2

# Rabin's RSA
# n = 201354090531918389422241515534761536573
# c = 20442989381348880630046435751193745753
#
# p = 14450452739004884887
# q = 13934102561950901579
#
# e=2
#
# inv_p = inverse(p,q)
# inv_q = inverse(q,p)
#
# mp = pow(c,(p+1)//4,p)
# mq = pow(c,(q+1)//4,q)
#
# a = (inv_p * p * mq + inv_q * q * mp) % n
# b = n - int(a)
# c = (inv_p * p * mq - inv_q * q * mp) % n
# d = n - int(c)
# print(long_to_bytes(a))
# print(long_to_bytes(b))
# print(long_to_bytes(c))
# print(long_to_bytes(d))
# #因为rabin 加密有四种结果，全部列出。
# aa=[a,b,c,d]
# for i in aa:
#     print(i)
#     print(libnum.n2s(int(i)))

p = 274539690398523616505159415195049044439
q = 322368694010594584041053487661458382819

c= 2709336316075650177079376244796188132561250459751152184677022745551914544884517324887652368450635995644019212878543745475885906864265559139379903049221765159852922264140740839538366147411533242116915892792672736321879694956051586399594206293685750573633107354109784921229088063124404073840557026747056910514218246
n= 3326716005321175474866311915397401254111950808705576293932345690533263108414883877530294339294274914837424580618375346509555627578734883357652996005817766370804842161603027636393776079113035745495508839749006773483720698066943577445977551268093247748313691392265332970992500440422951173889419377779135952537088733
e= 196608



# m = pow(c,d,n)
# print(long_to_bytes(m))

